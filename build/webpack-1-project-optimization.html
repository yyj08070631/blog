<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue1.0 + Webpack1 + Gulp项目升级构建方案的踩坑路 | 不肥的肥羊的博客</title>
    <meta name="description" content="Blog">
    <meta name="generator" content="VuePress 1.4.0">
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?34ffe82902ef2e02b9f8f8642ace8775";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
    
    <link rel="preload" href="/blog/assets/css/0.styles.de52748e.css" as="style"><link rel="preload" href="/blog/assets/js/app.62a48a99.js" as="script"><link rel="preload" href="/blog/assets/js/2.de018582.js" as="script"><link rel="preload" href="/blog/assets/js/12.01d0e66a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.34f50a32.js"><link rel="prefetch" href="/blog/assets/js/11.83174c0c.js"><link rel="prefetch" href="/blog/assets/js/13.9f1dca7d.js"><link rel="prefetch" href="/blog/assets/js/14.59d3abd5.js"><link rel="prefetch" href="/blog/assets/js/15.c438921b.js"><link rel="prefetch" href="/blog/assets/js/16.146f5974.js"><link rel="prefetch" href="/blog/assets/js/17.fb5cb070.js"><link rel="prefetch" href="/blog/assets/js/18.dfae62b0.js"><link rel="prefetch" href="/blog/assets/js/19.7cd5580f.js"><link rel="prefetch" href="/blog/assets/js/20.544bbe10.js"><link rel="prefetch" href="/blog/assets/js/21.fe60465c.js"><link rel="prefetch" href="/blog/assets/js/22.f346de1c.js"><link rel="prefetch" href="/blog/assets/js/23.d6ef8734.js"><link rel="prefetch" href="/blog/assets/js/24.156f7dad.js"><link rel="prefetch" href="/blog/assets/js/3.f6fda1f0.js"><link rel="prefetch" href="/blog/assets/js/4.5c1e4e4d.js"><link rel="prefetch" href="/blog/assets/js/5.8f0aa699.js"><link rel="prefetch" href="/blog/assets/js/6.98a9e9e2.js"><link rel="prefetch" href="/blog/assets/js/7.830922ff.js"><link rel="prefetch" href="/blog/assets/js/8.8d1f4131.js"><link rel="prefetch" href="/blog/assets/js/9.a523d9cd.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.de52748e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">不肥的肥羊的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div> <a href="https://github.com/yyj08070631/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div> <a href="https://github.com/yyj08070631/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>构建生态</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/build/html-webpack-plugin-4.x-optimization.html" class="sidebar-link">html-webpack-plugin 4.x 对多模板下热重载缓慢问题的修复</a></li><li><a href="/blog/build/webpack-1-project-optimization.html" class="active sidebar-link">Webpack1 项目构建方案升级</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/build/webpack-1-project-optimization.html#原有构建方案描述" class="sidebar-link">原有构建方案描述</a></li><li class="sidebar-sub-header"><a href="/blog/build/webpack-1-project-optimization.html#将gulp的功能移到webpack1上执行" class="sidebar-link">将Gulp的功能移到Webpack1上执行</a></li><li class="sidebar-sub-header"><a href="/blog/build/webpack-1-project-optimization.html#从webpack1升级到webpack3" class="sidebar-link">从Webpack1升级到Webpack3</a></li><li class="sidebar-sub-header"><a href="/blog/build/webpack-1-project-optimization.html#在webpack3下进行构建速度的优化" class="sidebar-link">在Webpack3下进行构建速度的优化</a></li><li class="sidebar-sub-header"><a href="/blog/build/webpack-1-project-optimization.html#后记" class="sidebar-link">后记</a></li><li class="sidebar-sub-header"><a href="/blog/build/webpack-1-project-optimization.html#q-a" class="sidebar-link">Q&amp;A</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Web 安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>UI/UX</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue1-0-webpack1-gulp项目升级构建方案的踩坑路"><a href="#vue1-0-webpack1-gulp项目升级构建方案的踩坑路" class="header-anchor">#</a> Vue1.0 + Webpack1 + Gulp项目升级构建方案的踩坑路</h1> <p>最近半年在维护公司的一个管理后台项目，搭建之初的技术栈比较混乱，构建方案采用了<code>Gulp</code>中调用<code>Webpack</code>的方式，<code>Gulp</code>负责处理<code>.html</code>文件，<code>Webpack</code>负责加载<code>.vue</code>、<code>.js</code>等。而在这一套构建方案中，主要有这些问题：</p> <ol><li>没有实现JS压缩、CSS兼容等功能。</li> <li>在开发模式下，保存代码，项目会进行完全的重新打包，持续构建速度不仅缓慢，还会产生缓存的现象（构建完成后刷新页面改动不生效）。</li> <li>由于目前的方案没有使用<code>http-proxy-middleware</code>这样的请求代理模块，导致项目在本地开发时还要部署后端服务，对新接手的开发者不友好，而且经常由于沟通不及时产生测试环境与本地环境的代码同步问题。</li></ol> <p>因此，在熟悉这个项目之后，打算对其构建方案进行升级，主要为了解决上述的问题。</p> <h2 id="原有构建方案描述"><a href="#原有构建方案描述" class="header-anchor">#</a> 原有构建方案描述</h2> <h3 id="原有构建速度"><a href="#原有构建速度" class="header-anchor">#</a> 原有构建速度</h3> <ul><li><code>npm run build</code>：打包约50s</li> <li><code>npm run dev</code>：开启开发模式约50s，保存自动重新编译需约6s，编译完成后需要刷新才能看到效果，偶尔因缓存问题需要再次自动重新编译才能看到效果</li></ul> <h3 id="原有构建结果"><a href="#原有构建结果" class="header-anchor">#</a> 原有构建结果</h3> <ul><li><code>./build/development</code>：存放渲染后的js文件</li> <li><code>./build/html</code>：存放渲染后的html文件</li> <li><code>./build/rev</code>：保存各个入口文件hash值的json文件</li></ul> <h3 id="打包代码解析"><a href="#打包代码解析" class="header-anchor">#</a> 打包代码解析</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * 使用gulp-clean插件删除build目录下的文件
 */</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'clean'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stopClean<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'build/'</span> <span class="token operator">+</span> directory<span class="token punctuation">,</span> <span class="token punctuation">{</span> read<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/**
 * 使用webpack打包vue与js文件，在clean之后进行
 */</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'clean'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    deCompiler<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">gutil<span class="token punctuation">.</span>PluginError</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        gutil<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[webpack]'</span><span class="token punctuation">,</span> stats<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/**
 * 使用gulp-uglify插件对js文件进行丑化，在webpack之后进行
 */</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'minify'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'webpack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'build/'</span> <span class="token operator">+</span> directory <span class="token operator">+</span> <span class="token string">'/*.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">uglify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/**
 * 使用gulp-rev插件为打包后的文件增加hash，在minify之后运行
 * 
 * gulp-rev会做什么：
 * 根据静态资源内容，生成md5签名，打包出来的文件名会加上md5签名，同时生成一个json用来保存文件名路径对应关系。
 * 替换html里静态资源的路径为带有md5值的文件路径，这样html才能找到资源路径。
 * 有些人可能会做：静态服务器配置静态资源的过期时间为永不过期。
 * 达到什么效果：
 * 静态资源只需请求一次，永久缓存，不会发送协商请求304
 * 版本更新只会更新修改的静态资源内容
 * 不删除旧版本的静态资源，版本回滚的时候只需要更新html，同样不会增加http请求次数
 */</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'hashJS'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'minify'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> dest <span class="token operator">=</span> gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'一串入口文件...'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 设置文件的hash key</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'build/'</span> <span class="token operator">+</span> directory<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 将经过管道处理的文件写出到目录</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>rev<span class="token punctuation">.</span><span class="token function">manifest</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 生成映射hash key的json</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'build/rev'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 将经过管道处理的文件写出到目录</span>
    <span class="token operator">!</span>environment <span class="token operator">&amp;&amp;</span> gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'一串入口文件...'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> dest
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/**
 * 使用gulp-rev-replace插件为html中引用的js和css替换新的hash
 * 使用gulp-livereload插件在所有文件重新打包完成后局部更新页面
 */</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'revReplace'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'hashJS'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'html/*.html'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">revReplace</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 给html中的js引用提供新的hash</span>
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'build/html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> 输出文件
        <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">livereload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> 局部更新页面
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/**
 * 使用gulp.watch，当应用程序目录下有任何文件发生改变，则重新执行一遍打包命令
 * gulp.watch：监视文件，并且可以在文件发生改动时候做一些事情。
 */</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'watch'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'revReplace'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    stopClean <span class="token operator">=</span> <span class="token boolean">true</span>
    livereload<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    gulp<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">'app/**/*'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'clean'</span><span class="token punctuation">,</span> <span class="token string">'webpack'</span><span class="token punctuation">,</span> <span class="token string">'minify'</span><span class="token punctuation">,</span> <span class="token string">'hashJS'</span><span class="token punctuation">,</span> <span class="token string">'revReplace'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/**
 * 输出dev和build的工作流
 */</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'clean'</span><span class="token punctuation">,</span> <span class="token string">'webpack'</span><span class="token punctuation">,</span> <span class="token string">'minify'</span><span class="token punctuation">,</span> <span class="token string">'hashJS'</span><span class="token punctuation">,</span> <span class="token string">'revReplace'</span><span class="token punctuation">,</span> <span class="token string">'watch'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// dev</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'clean'</span><span class="token punctuation">,</span> <span class="token string">'webpack'</span><span class="token punctuation">,</span> <span class="token string">'minify'</span><span class="token punctuation">,</span> <span class="token string">'hashJS'</span><span class="token punctuation">,</span> <span class="token string">'revReplace'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// build</span>
<span class="token comment">/**
 * webpack配置
 */</span>
<span class="token keyword">var</span> devCompiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span> <span class="token comment">// 一众入口文件</span>
        vendor<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'vue-router'</span><span class="token punctuation">,</span> <span class="token string">'lodash'</span><span class="token punctuation">,</span> <span class="token string">'echarts'</span><span class="token punctuation">]</span> <span class="token comment">// 公共模块</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span> <span class="token comment">// 所有输出文件的目标路径</span>
        publicPath<span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span> <span class="token comment">// 输出解析文件的目录</span>
        filename<span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span> <span class="token comment">// 输出文件</span>
        chunkFilename<span class="token operator">:</span> <span class="token operator">...</span> <span class="token comment">// 通过异步请求的文件</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 排除以下内容打包到 bundle，减小文件大小</span>
    external<span class="token operator">:</span> <span class="token punctuation">{</span>
        jquery<span class="token operator">:</span> <span class="token string">'jQuery'</span><span class="token punctuation">,</span>
        dialog<span class="token operator">:</span> <span class="token string">'dialog'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">/**
         * 通过将公共模块拆出来，最终合成的文件能够在最开始的时候加载一次，便存到缓存中供后续使用。
         * 这个带来页面速度上的提升，因为浏览器会迅速将公共的代码从缓存中取出来，而不是每次访问一个新页面时，再去加载一个更大的文件。
         */</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'vendor'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">/**
         * DefinePlugin 允许创建一个在编译时可以配置的全局常量。这可能会对开发模式和生产模式的构建允许不同的行为非常有用。
         */</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            __VERSION__<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
        root<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
        extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.vue'</span><span class="token punctuation">,</span> <span class="token string">'.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 解析组件的文件后缀白名单</span>
        alias<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token comment">// 配置路径别名</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 各个文件的loaders</span>
        loaders<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex">/\.vue$/</span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">'vue-loader'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">'style-loader!css-loader'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex">/\.jsx$/</span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span> include<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> exclude<span class="token operator">:</span> <span class="token regex">/core/</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex">/\.json$/</span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">'json'</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    vue<span class="token operator">:</span> <span class="token punctuation">{</span>
        loaders<span class="token operator">:</span> <span class="token punctuation">{</span>
            js<span class="token operator">:</span> <span class="token string">'babel-loader'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="将gulp的功能移到webpack1上执行"><a href="#将gulp的功能移到webpack1上执行" class="header-anchor">#</a> 将<code>Gulp</code>的功能移到<code>Webpack1</code>上执行</h2> <h3 id="使用html-webpack-plugin插件构建项目的主-html文件"><a href="#使用html-webpack-plugin插件构建项目的主-html文件" class="header-anchor">#</a> 使用<code>html-webpack-plugin</code>插件构建项目的主<code>.html</code>文件</h3> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            filename<span class="token operator">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span> <span class="token comment">// 输出的路径</span>
            template<span class="token operator">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span> <span class="token comment">// 提取源html的路径</span>
            chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'...'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 需要导入的模块</span>
            inject<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 是否附加到body底部</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用webpack-optimize-uglifyjsplugin插件进行js压缩"><a href="#使用webpack-optimize-uglifyjsplugin插件进行js压缩" class="header-anchor">#</a> 使用<code>webpack.optimize.UglifyJsPlugin</code>插件进行<code>JS</code>压缩</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            compress<span class="token operator">:</span> <span class="token punctuation">{</span> warnings<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用webpack-dev-server模块，提供node搭建的开发环境"><a href="#使用webpack-dev-server模块，提供node搭建的开发环境" class="header-anchor">#</a> 使用<code>webpack-dev-server</code>模块，提供<code>node</code>搭建的开发环境</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
        clientLogLevel<span class="token operator">:</span> <span class="token string">'warning'</span><span class="token punctuation">,</span> <span class="token comment">// 输出日志的级别，配置为警告级别以上才输出</span>
        inline<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 启动 live reload</span>
        hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 允许启用热重载</span>
        compress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 对所有静态资源进行gzip压缩</span>
        open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 默认在启动本地服务时打开浏览器</span>
        quiet<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 禁止输出繁杂的构建日志</span>
        host<span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span> <span class="token comment">// 服务启动的域名</span>
        port<span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span> <span class="token comment">// 服务启动的端口</span>
        proxy<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// http代理配置</span>
        <span class="token comment">/**
         * 这个配置常用于解决spa应用h5路由模式下将所有404路由匹配回index.html的问题
         * 由于生产环境为主页匹配了一个比较简单的别名，因此开发环境也照搬后端服务的配置
         */</span>
        historyApiFallback<span class="token operator">:</span> <span class="token punctuation">{</span>
            rewrites<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token operator">:</span> <span class="token string">'/^\/admin/'</span><span class="token punctuation">,</span> to<span class="token operator">:</span> <span class="token string">'...'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="踩坑"><a href="#踩坑" class="header-anchor">#</a> 踩坑</h3> <ol><li><code>webpack-dev-server@3.2.1 requires a peer of webpack^@4.0.0 but none is installed.</code>：这两个模块版本不兼容，回退到<code>webpack-dev-server@2</code>成功运行。</li> <li><code>Cannot resolve module 'fsevents' ...</code>：将全局的<code>webpack</code>调用改为直接从<code>node_modules/webpack</code>下直接调用，解决了问题，<code>node node_modules/webpack/bin/webpack.js --config webpack.config.js</code>。</li> <li><code>Cannot resolve module 'fs' ...</code>：配置<code>config.node.fs = 'empty'</code>，为<code>Webpack</code>提供<code>node</code>原生模块，使其能加载到这个对象。</li> <li>热重载只对<code>.js</code>和<code>.css</code>及<code>.vue</code>中的<code>&lt;style&gt;</code>内样式生效，对<code>.vue</code>文件中的<code>html</code>模板及<code>js</code>内容都不生效，会打印“模块代码已发生改变并重新编译，但热重载不生效，可能会启用全局刷新的策略”之类的信息，暂时没有解决，初步判断是低版本的<code>vue-hot-reload-api</code>对这些部分的处理有问题，有大神了解原理可以在评论区科普一哈=.=。</li></ol> <h2 id="从webpack1升级到webpack3"><a href="#从webpack1升级到webpack3" class="header-anchor">#</a> 从<code>Webpack1</code>升级到<code>Webpack3</code></h2> <p>由于<code>Webpack2</code>与<code>Webpack3</code>几乎完全兼容，只是涉及到一些增量的功能，因此选择直接从<code>Webpack1</code>迁移到<code>Webapck3</code>，先在项目中安装<code>Webpack3</code>，然后根据<code>Webpack2</code>文档中《从<code>Webpack1</code>迁移》的章节，对配置项进行更改，参考的文档戳这个：https://www.html.cn/doc/webpack2/guides/migrating/</p> <p>这次升级没有遇到什么问题，根据文档配置稍作更改就跑通了。梳理一下目前为止实现的功能：</p> <ol><li>新的<code>Webpack</code>构建代码已经实现了原有的所有功能，下面列举新增的功能。</li> <li>使用<code>webpack-dev-server</code>作为开发服务器，实现了保存时<code>live reload</code>的功能。</li> <li>使用<code>http-proxy-middleware</code>插件，将请求直接代理到测试服，让开发环境脱离了本地部署的后端服务，大大降低了开发环境部署的时间成本。</li> <li>新增<code>friendly-errors-webpack-plugin</code>，输出友好的构建日志，打印几个重要模块的开发环境地址，配置方面完全参考了<code>vue-cli@2</code>的默认配置。</li> <li>新增<code>postcss-loader</code>，对css添加兼容处理，配置方面完全参考了<code>vue-cli@2</code>的默认配置。</li> <li>使用<code>webpack.optimize.UglifyJsPlugin</code>压缩js代码。</li></ol> <p>尝试进行构建，输出构建时间记录：</p> <ul><li><code>npm run build</code>：约<code>135s</code></li> <li><code>npm run dev</code>：初次构建约<code>58s</code>，持续构建约<code>30s</code></li></ul> <p>项目构建时间过长（第一次打包把自己吓了一跳...），只能继续寻求构建速度上的优化</p> <h2 id="在webpack3下进行构建速度的优化"><a href="#在webpack3下进行构建速度的优化" class="header-anchor">#</a> 在<code>Webpack3</code>下进行构建速度的优化</h2> <h3 id="使用webpack-jarvis监测构建性能"><a href="#使用webpack-jarvis监测构建性能" class="header-anchor">#</a> 使用<code>webpack-jarvis</code>监测构建性能</h3> <p><code>webpack-jarvis</code>是一个图形化的webpack性能监测工具，它配置简便，对构建过程的时间占比、构建结果的详细记录都有具体的输出</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 经过简单的配置就可以在本地3001端口输出构建结果记录</span>
<span class="token keyword">const</span> Jarvis <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-jarvis'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">Jarvis</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            watchOnly<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            port<span class="token operator">:</span> <span class="token number">3001</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用happypack"><a href="#使用happypack" class="header-anchor">#</a> 使用<code>happypack</code></h3> <p>先根据网上搜到的文章，做一些简单的优化，如使用<code>happypack</code>，这个模块通过多进程模型，来加速代码构建，但是使用之后貌似没有太明显的结果，构建时间大概减少了几秒吧...暂时还不太懂这个模块对优化什么场景的效果比较明显，之前有看到一篇讲解<code>happypack</code>原理的文章，但还没细看，有兴趣小伙伴可以研究一下，要是能在评论里简洁明了的给渣渣楼主解释一下就更好了TUT：http://taobaofed.org/blog/2016/12/08/happypack-source-code-analysis/</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> HappyPack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'happypack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> happyThreadPool <span class="token operator">=</span> HappyPack<span class="token punctuation">.</span><span class="token function">ThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">{</span> size<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token punctuation">}</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">// happypack的id，在调用时需要声明，若需要编译其他类型的文件需要再声明一个happypack</span>
            id<span class="token operator">:</span> <span class="token string">'js'</span><span class="token punctuation">,</span>
            <span class="token comment">// cacheDirectory：设置后，将尽量在babel编译时使用缓存加载器的结果，避免重新走一遍babel的高昂代价</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span> cacheDirectory<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token comment">// 根据cpu的核心数判断需要拆分多少个进程池</span>
            threadPool<span class="token operator">:</span> happyThreadPool<span class="token punctuation">,</span>
            <span class="token comment">// 是否输出编译过程的日志</span>
            verbose<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>做完这一步后，输出构建时间记录：</p> <ul><li><code>npm run build</code>：约<code>130s</code></li> <li><code>npm run dev</code>：初次构建约<code>60s</code>，持续构建约<code>30s</code></li></ul> <h3 id="devtool配置为cheap-module-eval-source-map"><a href="#devtool配置为cheap-module-eval-source-map" class="header-anchor">#</a> <code>devtool</code>配置为<code>cheap-module-eval-source-map</code></h3> <p><code>devtool</code>选项启用<code>cheap-module-eval-source-map</code>模式：<code>vue-cli@2</code>默认配置为这种模式，<code>cheap</code>代表在输出<code>source-map</code>时省略列信息；<code>module</code>表示在编译过程中启用如<code>babel-loader</code>这样的预编译器，使得调试时可以直接看到未经编译的源代码；<code>eval</code>表示启用<code>eval</code>模式编译，该模式直接使用<code>eval</code>函数执行编译后模块的字符串，减少了将字符串转化为可执行的代码文件这个步骤，加快了项目开发中重建的速度；<code>source-map</code>表示输出源代码的映射表，使得开发时可以直接把错误定位到源代码，提高开发效率。</p> <p>做完这一步后，效果并不明显=.=（相比原来的<code>source-map</code>），大概减少了几秒，输出构建时间记录：</p> <ul><li><code>npm run build</code>：约<code>130s</code></li> <li><code>npm run dev</code>：初次构建约<code>58s</code>，持续构建约<code>30s</code></li></ul> <h3 id="使用html-webpack-plugin-for-multihtml提升多入口项目重建速度"><a href="#使用html-webpack-plugin-for-multihtml提升多入口项目重建速度" class="header-anchor">#</a> 使用<code>html-webpack-plugin-for-multihtml</code>提升多入口项目重建速度</h3> <p>重建一次竟然需要<code>30s</code>！各种搜索找到了<code>html-webpack-plugin</code>的一条<code>issue</code>，发现<code>html-webpack-plugin@2</code>在构建多入口应用时速度确实有明显变慢的情况，原因是没有成功的对构建内容进行缓存，使每次重建都重新编译所有代码。作者给出的解决方案是使用这个模块的一个分支项目（是由作者本人<code>fork</code>原项目并针对这个问题进行修复的项目）<code>html-webpack-plugin-for-multihtml</code>，用法与<code>html-webpack-plugin</code>完全相同，使用之后重建仅需<code>1s</code>左右。</p> <p>做完这一步后，输出构建时间记录：</p> <ul><li><code>npm run build</code>：约<code>130s</code></li> <li><code>npm run dev</code>：初次构建约<code>58s</code>，持续构建约<code>1s</code></li></ul> <h3 id="使用webpack-dllplugin提取公共模块"><a href="#使用webpack-dllplugin提取公共模块" class="header-anchor">#</a> 使用<code>webpack.DllPlugin</code>提取公共模块</h3> <p>在输出结果中找到了不少较大的依赖包，如<code>Vue</code>的核心库、<code>lodash</code>、<code>echarts</code>等等，还有一些不希望被打包的静态资源，想办法避免每次都编译这些内容，提升编译速度，所以找到了这个插件。</p> <p><code>webpack.DllPlugin</code>这个插件是来源于<code>Windows</code>系统的<code>.dll</code>文件（动态链接库）的用法：首先通过<code>DllPlugin</code>模块构建出一个包含公共模块的包和一个映射表，再通过<code>DllReferencePlugin</code>模块通过映射表给每个模块关联对应的依赖，这样可以对这些公共模块进行预先打包，以后构建的时候就不需要处理这些模块，减少打包时间。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.dll.conf.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        vendor<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'build/development'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
        library<span class="token operator">:</span> <span class="token string">'[name]_library'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'build/development/[name]-manifest.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 生成manifest文件输出的位置和文件名称</span>
            name<span class="token operator">:</span> <span class="token string">'[name]-library'</span><span class="token punctuation">,</span> <span class="token comment">// 与output.library是一样的，对应manifest.json文件中name字段的值，防止全局变量冲突</span>
            context<span class="token operator">:</span> __dirname
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// webpack.base.conf.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
            manifest<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../build/development/vendor-manifest.json'</span><span class="token punctuation">)</span> <span class="token comment">// 让webpack从映射表获取使用的依赖</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>打包出来之后还需要在html文件中引入公共库<code>vendor.dll.js</code>文件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/build/development/vendor.dll.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 其他JS应该注入到dll的后面，确保能够引用到公共库的内容 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>做完这一步后，输出构建时间记录，发现构建效率有了明显的提高：</p> <ul><li><code>npm run dll</code>：约<code>25s</code></li> <li><code>npm run build</code>：约<code>70s</code></li> <li><code>npm run dev</code>：初次构建约<code>55s</code>，持续构建约<code>1s</code></li></ul> <h2 id="后记"><a href="#后记" class="header-anchor">#</a> 后记</h2> <p>优化到这里就差不多结束，这次的优化为旧项目提供了新一代<code>spa</code>项目应有的一些功能，搭建了更现代的本地开发环境。下面贴上升级后的完整配置：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.prod.conf.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> baseWebpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack-base.conf'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./utils'</span><span class="token punctuation">)</span>

process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">=</span> <span class="token string">'production'</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseWebpackConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>utils<span class="token punctuation">.</span><span class="token function">htmlWebpackPluginConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// webpack.dev.conf.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> baseWebpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack-base.conf'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> FriendlyErrorsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'friendly-errors-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./utils'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> proxyDomain <span class="token operator">=</span> <span class="token string">'...'</span>
<span class="token keyword">const</span> host <span class="token operator">=</span> <span class="token string">'...'</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token operator">...</span>

process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">=</span> <span class="token string">'development'</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseWebpackConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  devtool<span class="token operator">:</span> <span class="token string">'cheap-module-eval-source-map'</span><span class="token punctuation">,</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    clientLogLevel<span class="token operator">:</span> <span class="token string">'warning'</span><span class="token punctuation">,</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    inline<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    compress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    host<span class="token operator">:</span> host<span class="token punctuation">,</span>
    port<span class="token operator">:</span> port<span class="token punctuation">,</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    historyApiFallback<span class="token operator">:</span> <span class="token punctuation">{</span>
      rewrites<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token operator">:</span> <span class="token regex">/^\/admin/</span><span class="token punctuation">,</span> to<span class="token operator">:</span> <span class="token string">'...'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>NamedModulesPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>NoEmitOnErrorsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">FriendlyErrorsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      compilationSuccessInfo<span class="token operator">:</span> <span class="token punctuation">{</span>
        messages<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'...'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      onErrors<span class="token operator">:</span> utils<span class="token punctuation">.</span><span class="token function">createNotifierCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>utils<span class="token punctuation">.</span><span class="token function">htmlWebpackPluginConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// webpack.base.conf.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HappyPack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'happypack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./utils'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> happyThreadPool <span class="token operator">=</span> HappyPack<span class="token punctuation">.</span><span class="token function">ThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">{</span> size<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token parameter">dir</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">,</span> dir<span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  context<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    publicPath<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span>
    chunkFilename<span class="token operator">:</span> <span class="token string">'...'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  externals<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    modules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    extentions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'...'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.vue$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'vue-loader'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              loaders<span class="token operator">:</span> <span class="token punctuation">{</span>
                js<span class="token operator">:</span> <span class="token string">'happypack/loader?id=js'</span><span class="token punctuation">,</span>
                <span class="token operator">...</span>utils<span class="token punctuation">.</span><span class="token function">cssLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                cssSourceMap<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
                cacheBusting<span class="token operator">:</span> <span class="token boolean">true</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'vue-style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">'happypack/loader?id=js'</span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
      manifest<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../build/development/vendor-manifest.json'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'js'</span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span> cacheDirectory<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      threadPool<span class="token operator">:</span> happyThreadPool<span class="token punctuation">,</span>
      verbose<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  node<span class="token operator">:</span> <span class="token punctuation">{</span>
    fs<span class="token operator">:</span> <span class="token string">'empty'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// webpack.dll.conf.js</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token parameter">dir</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">,</span> dir<span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    vendor<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'build/development'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
    library<span class="token operator">:</span> <span class="token string">'[name]_library'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'build/development/[name]-manifest.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">'[name]-library'</span><span class="token punctuation">,</span>
      context<span class="token operator">:</span> __dirname
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="q-a"><a href="#q-a" class="header-anchor">#</a> Q&amp;A</h2> <p>Q: 为什么不直接升级到<code>Webpack4</code>？</p> <p>A: <code>Webpack4</code>只支持<code>vue-loader@15</code>以上版本，而这个版本已经无法解析<code>Vue1</code>的文件。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/yyj08070631/blog/edit/master/docs/build/webpack-1-project-optimization.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/9/2020, 1:02:12 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/build/html-webpack-plugin-4.x-optimization.html" class="prev">
        html-webpack-plugin 4.x 对多模板下热重载缓慢问题的修复
      </a></span> <span class="next"><a href="/blog/network/001.html">
        001 HTTP 状态码
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.62a48a99.js" defer></script><script src="/blog/assets/js/2.de018582.js" defer></script><script src="/blog/assets/js/12.01d0e66a.js" defer></script>
  </body>
</html>
